<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Project Form Extension -->
        <record id="view_project_form_ptt" model="ir.ui.view">
            <field name="name">project.project.form.ptt</field>
            <field name="model">project.project</field>
            <field name="inherit_id" ref="project.edit_project"/>
            <field name="arch" type="xml">
                <xpath expr="//notebook" position="inside">
                    
                    <!-- PTT Event Details -->
                    <page string="Event Details" name="ptt_event_details">
                        <group>
                            <group string="Event Identity">
                                <field name="x_plan2_id" readonly="1"/>
                                <field name="ptt_crm_lead_id"/>
                                <field name="x_studio_event_name"/>
                            </group>
                            <group string="Event Schedule">
                                <field name="x_studio_event_date"/>
                                <field name="ptt_event_start_time"/>
                                <field name="ptt_event_end_time"/>
                                <field name="ptt_total_hours"/>
                                <field name="ptt_guest_count"/>
                            </group>
                        </group>
                        <group>
                            <group string="Venue">
                                <field name="x_studio_venue_name"/>
                                <field name="ptt_location_type"/>
                                <field name="x_studio_venue_address"/>
                            </group>
                        </group>
                    </page>

                    <!-- Vendor Assignments -->
                    <page string="Vendor Assignments" name="ptt_vendors">
                        <!-- Profitability Dashboard -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center py-3">
                                        <h6 class="card-subtitle mb-1 opacity-75">Client Revenue</h6>
                                        <h4 class="card-title mb-0">
                                            <field name="ptt_client_total" widget="monetary" nolabel="1"/>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center py-3">
                                        <h6 class="card-subtitle mb-1 opacity-75">Est. Vendor Costs</h6>
                                        <h4 class="card-title mb-0">
                                            <field name="ptt_total_estimated_cost" widget="monetary" nolabel="1"/>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning">
                                    <div class="card-body text-center py-3">
                                        <h6 class="card-subtitle mb-1">Actual Costs</h6>
                                        <h4 class="card-title mb-0">
                                            <field name="ptt_total_actual_cost" widget="monetary" nolabel="1"/>
                                        </h4>
                                        <small class="text-muted">
                                            Variance: <field name="ptt_cost_variance" widget="monetary" nolabel="1"/>
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center py-3">
                                        <h6 class="card-subtitle mb-1 opacity-75">Profit Margin</h6>
                                        <h4 class="card-title mb-0">
                                            <field name="ptt_actual_margin" widget="monetary" nolabel="1"/>
                                        </h4>
                                        <small>
                                            (<field name="ptt_margin_percent" nolabel="1"/>%)
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <group>
                            <group string="Vendor Summary">
                                <field name="ptt_vendor_count" readonly="1"/>
                            </group>
                        </group>
                        
                        <separator string="Vendor Assignments"/>
                        <field name="ptt_vendor_assignment_ids" nolabel="1">
                            <list editable="bottom">
                                <field name="service_type"/>
                                <field name="vendor_id"/>
                                <field name="vendor_name"/>
                                <field name="estimated_cost"/>
                                <field name="actual_cost"/>
                                <field name="status"/>
                                <field name="service_date"/>
                            </list>
                        </field>
                    </page>

                    <!-- Event Notes -->
                    <page string="Event Notes" name="ptt_notes">
                        <group>
                            <field name="ptt_event_notes" placeholder="General event notes..."/>
                        </group>
                        <group>
                            <field name="ptt_special_requirements" placeholder="Special requirements..."/>
                        </group>
                        <group>
                            <field name="ptt_client_preferences" placeholder="Client preferences..."/>
                        </group>
                    </page>

                </xpath>
            </field>
        </record>

        <!-- Project Tree Extension -->
        <record id="view_project_tree_ptt" model="ir.ui.view">
            <field name="name">project.project.tree.ptt</field>
            <field name="model">project.project</field>
            <field name="inherit_id" ref="project.view_project"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="x_studio_event_date" optional="show"/>
                    <field name="ptt_guest_count" optional="hide"/>
                    <field name="ptt_client_total" string="Revenue" optional="show" widget="monetary"/>
                    <field name="ptt_actual_margin" string="Margin" optional="show" widget="monetary"
                           decoration-success="ptt_actual_margin &gt; 0"
                           decoration-danger="ptt_actual_margin &lt; 0"/>
                    <field name="ptt_margin_percent" string="%" optional="hide"/>
                </field>
            </field>
        </record>

    </data>
</odoo>
