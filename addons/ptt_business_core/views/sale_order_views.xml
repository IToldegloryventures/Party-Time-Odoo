<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- 
        Sale Order View Extensions for PTT
        
        Adds:
        1. Tier 1 info header on quote form (Event Date, Venue, Guest Count)
        2. Price Per Person on form, kanban, and tree views
        3. INTERNAL Pricing Reference section with DJ pricing matrix
        4. Order line pricing info (min/max rate, min hours)
        
        INTERNAL ONLY: Pricing reference sections are for sales reps only.
        They do NOT appear on printed quotes/invoices.
        
        Reference: https://www.odoo.com/documentation/19.0/developer/reference/user_interface/view_architectures.html
    -->
    
    <!-- ===================================== -->
    <!-- FORM VIEW: Add Tier 1 Header + Price  -->
    <!-- ===================================== -->
    <record id="view_order_form_ptt_inherit" model="ir.ui.view">
        <field name="name">sale.order.form.ptt</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <!-- Add Event Details group after partner info -->
            <xpath expr="//field[@name='partner_id']/.." position="after">
                <group string="Event Details" name="ptt_event_details">
                    <group>
                        <field name="ptt_event_date"/>
                        <field name="ptt_event_type"/>
                        <field name="ptt_venue_name"/>
                    </group>
                    <group>
                        <field name="ptt_guest_count"/>
                        <field name="ptt_event_time"/>
                        <field name="ptt_price_per_person" widget="monetary"/>
                    </group>
                </group>
            </xpath>
            
            <!-- =========================================================== -->
            <!-- INTERNAL PRICING REFERENCE - DJ Services Matrix              -->
            <!-- This section is for INTERNAL USE ONLY - helps sales reps    -->
            <!-- know the pricing ranges. NEVER appears on customer documents -->
            <!-- =========================================================== -->
            <xpath expr="//notebook" position="inside">
                <page string="ðŸ“Š Pricing Reference" name="ptt_pricing_reference"
                      groups="sales_team.group_sale_salesman">
                    <div class="alert alert-info mb-3" role="alert">
                        <strong>ðŸ”’ Internal Reference Only</strong> - This pricing guide helps you quote accurately. 
                        It does NOT appear on customer quotes or invoices.
                    </div>
                    
                    <!-- DJ Services Pricing Matrix -->
                    <div class="row">
                        <div class="col-12">
                            <h4>ðŸŽ§ DJ Services - Hourly Rates</h4>
                            <table class="table table-sm table-bordered">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Event Type</th>
                                        <th>Tier</th>
                                        <th>Min Hours</th>
                                        <th>Guest Range</th>
                                        <th>Min Rate</th>
                                        <th>Max Rate</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- SOCIAL -->
                                    <tr class="table-light">
                                        <td rowspan="3"><strong>Social</strong></td>
                                        <td>Essentials</td>
                                        <td>2 hrs</td>
                                        <td>1-100</td>
                                        <td><strong>$300</strong></td>
                                        <td>$400</td>
                                    </tr>
                                    <tr class="table-light">
                                        <td>Classic</td>
                                        <td>2 hrs</td>
                                        <td>101-175</td>
                                        <td><strong>$425</strong></td>
                                        <td>$600</td>
                                    </tr>
                                    <tr class="table-light">
                                        <td>Premier</td>
                                        <td>2 hrs</td>
                                        <td>176+</td>
                                        <td><strong>$600</strong></td>
                                        <td>$675</td>
                                    </tr>
                                    <!-- CORPORATE -->
                                    <tr>
                                        <td rowspan="3"><strong>Corporate</strong></td>
                                        <td>Essentials</td>
                                        <td>2 hrs</td>
                                        <td>1-100</td>
                                        <td><strong>$300</strong></td>
                                        <td>$400</td>
                                    </tr>
                                    <tr>
                                        <td>Classic</td>
                                        <td>2 hrs</td>
                                        <td>101-250</td>
                                        <td><strong>$425</strong></td>
                                        <td>$600</td>
                                    </tr>
                                    <tr>
                                        <td>Premier</td>
                                        <td>2 hrs</td>
                                        <td>251-500</td>
                                        <td><strong>$600</strong></td>
                                        <td>$675</td>
                                    </tr>
                                    <!-- WEDDING -->
                                    <tr class="table-warning">
                                        <td rowspan="3"><strong>Wedding</strong></td>
                                        <td>Essentials</td>
                                        <td><strong>3 hrs</strong></td>
                                        <td>50-350</td>
                                        <td><strong>$350</strong></td>
                                        <td>$450</td>
                                    </tr>
                                    <tr class="table-warning">
                                        <td>Classic</td>
                                        <td><strong>4 hrs</strong></td>
                                        <td>101-250</td>
                                        <td><strong>$475</strong></td>
                                        <td>$625</td>
                                    </tr>
                                    <tr class="table-warning">
                                        <td>Premier</td>
                                        <td><strong>5 hrs</strong></td>
                                        <td>251-500</td>
                                        <td><strong>$650</strong></td>
                                        <td>$700</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Quick Tips -->
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <strong>âœ… Pricing Tips</strong>
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li><strong>Start at MIN</strong> - Default quote price</li>
                                        <li><strong>Negotiate up to MAX</strong> - For premium requests</li>
                                        <li><strong>6+ hour events</strong> - Consider 1.5x rate</li>
                                        <li><strong>Check guest count</strong> - Use appropriate tier</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <strong>ðŸ’¡ Tier Selection Guide</strong>
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li><strong>Essentials</strong> - Basic setup, budget-conscious</li>
                                        <li><strong>Classic</strong> - Professional DJ services, lighting included</li>
                                        <li><strong>Premier</strong> - Premium experience, all extras</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </page>
            </xpath>
        </field>
    </record>
    
    <!-- ============================================= -->
    <!-- ORDER LINE PRICING COLUMNS                   -->
    <!-- NOTE: Removed - price_unit field not found   -->
    <!-- in Odoo 19 parent views. The pricing info    -->
    <!-- is available via the Pricing Reference tab.  -->
    <!-- ============================================= -->
    <!-- 
        The ptt_price_min, ptt_price_max, ptt_min_hours fields exist
        on sale.order.line but cannot be added to the line tree due
        to Odoo 19 view structure changes.
        
        Sales reps can use the "Pricing Reference" tab on the quote
        form to see the pricing matrix for DJ services.
    -->
    
    <!-- ===================================== -->
    <!-- TREE/LIST VIEW: Add columns          -->
    <!-- ===================================== -->
    <record id="view_order_tree_ptt_inherit" model="ir.ui.view">
        <field name="name">sale.order.tree.ptt</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='amount_total']" position="before">
                <field name="ptt_event_date" optional="show"/>
                <field name="ptt_guest_count" optional="show"/>
                <field name="ptt_price_per_person" optional="show"/>
            </xpath>
        </field>
    </record>
</odoo>
