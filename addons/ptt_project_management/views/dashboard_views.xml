<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

        <!-- ================================================================ -->
        <!-- PTT PROJECT DASHBOARD - CLIENT ACTION                            -->
        <!-- ================================================================ -->
        <!-- 
        This registers the custom Owl dashboard component as a client action.
        The "tag" MUST match the registry key in dashboard.js:
            registry.category("actions").add("ptt_project_dashboard", PTTProjectDashboard);
        -->

        <record id="ptt_project_dashboard_action" model="ir.actions.client">
            <field name="name">PTT Project Dashboard</field>
            <field name="tag">ptt_project_dashboard</field>
            <field name="target">main</field>
            <field name="res_model">project.project</field>
            <field name="context">{
                'ptt_dashboard': True,
            }</field>
            <field name="params">{
                'title': 'Project Dashboard',
            }</field>
        </record>

        <!-- ================================================================ -->
        <!-- MENU ITEMS - DASHBOARD AND PROJECTS                              -->
        <!-- ================================================================ -->

        <!-- Dashboard as first menu item (sequence=1) -->
        <menuitem id="ptt_menu_project_dashboard"
                  name="Dashboard"
                  parent="project.menu_main_pm"
                  action="ptt_project_dashboard_action"
                  sequence="1"
                  groups="base.group_user"/>

        <!-- ================================================================ -->
        <!-- OVERRIDE: Make Dashboard the DEFAULT when clicking Projects app  -->
        <!-- ================================================================ -->
        <!-- 
        This changes the root menu item of the Projects app to open the 
        PTT Dashboard instead of the default project kanban view.
        Users can still access the kanban/list via the "All Projects" submenu.
        -->

        <!-- Override the root Projects menu to point to Dashboard -->
        <record id="project.menu_main_pm" model="ir.ui.menu">
            <field name="action" ref="ptt_project_dashboard_action"/>
        </record>

        <!-- Add explicit "All Projects" menu for kanban/list access -->
        <menuitem id="ptt_menu_all_projects"
                  name="All Projects"
                  parent="project.menu_main_pm"
                  action="project.open_view_project_all"
                  sequence="5"
                  groups="base.group_user"/>

    </data>
</odoo>
